import{F as p,G as s,K as i,S as x,T as v}from"./chunk-L22JM56C.js";var d={};function _(a,e){let t=0;for(let o=0;o<e;o++)t=t*31+a[o].uid>>>0;return d[t]||f(a,t)}var c=0;function f(a,e){let t={},o=0;c||(c=v());for(let r=0;r<c;r++){let l=r<a.length?a[r]:i.EMPTY.source;t[o++]=l.source,t[o++]=l.style}let n=new x(t);return d[e]=n,n}var u=class{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){let o=p.get().createCanvas();o.width=e,o.height=t;let n=o.getContext("2d");return{canvas:o,context:n}}getOptimalCanvasAndContext(e,t,o=1){e=Math.ceil(e*o-1e-6),t=Math.ceil(t*o-1e-6),e=s(e),t=s(t);let n=(e<<17)+(t<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let r=this._canvasPool[n].pop();return r||(r=this._createCanvasAndContext(e,t)),r}returnCanvasAndContext(e){let t=e.canvas,{width:o,height:n}=t,r=(o<<17)+(n<<1);this._canvasPool[r].push(e)}clear(){this._canvasPool={}}},b=new u;export{_ as a,b};
